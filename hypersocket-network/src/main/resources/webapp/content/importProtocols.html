<div class="modal" id="importProtocols" tabindex="-1" role="dialog">
	<div class="modal-dialog"> 
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title" localize="importProtocols.title"></h4>
			</div>
			<div class="modal-body">

				<div id="importProtocolsProperties"></div>
				<div id="tabUploadProperties" class="dialogTab">
					<div class="propertyItem form-group">
						<label for="file" class="col-md-3 control-label"
							localize="importProtocols.file.label"></label>
						<div class="propertyValue col-md-9">
							<input type="file" name="jsonFile" id="jsonFile" class="form-control" />
							<div>
								<span class="help-block" localize="importProtocols.file.info"></span>
							</div>
						</div>
					</div>
				</div>
				
			</div>
			<div class="modal-footer">
				<button id="importProtocolsButton" type="button" class="btn btn-primary">
					<i id="uploadIcon" class="fa fa-upload"></i><span
						localize="importProtocolsButton.label"></span>
				</button>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function() {
		$('#importProtocols').localize();
		
		$('#importProtocolsProperties').propertyPage({
			url : 'template/launchers/import',
			showButtons : false,
			useTemplates : true,
			canUpdate : currentMenu.canUpdate,
			additionalTabs : [ 
				{
					id : "tabUploadProperties",
					name : getResource("importProtocols.tab")
				}
			]
		});

		$('#importProtocols').data('action', function(callback) {
			$('#jsonFile').val('');
			$('#importProtocols').data('callback', callback);
			$('#importProtocols').modal('show');
			$('#importProtocols').resourceDialog('error','reset');
		});

		$('#importProtocolsButton').click(function(e) {
	
			if (!$('#jsonFile')[0].files[0]) {
				$('#importProtocols').resourceDialog('error', getResource("error.selectProtocolsFile"));
				return;
			}
			
			var formData = new FormData();
			formData.append('file', $('#jsonFile')[0].files[0]);
			$('#uploadIcon').removeClass('fa-upload');
			$('#uploadIcon').addClass('fa-spinner fa-spin');
			$.ajax({
				type : 'POST',
				url : basePath +'/api/networkProtocols/importProtocols/',  
				dataType : 'json',
				cache : false,
				contentType : false,
				processData : false,
				data : formData,
				success : function(data) {
			 				if (data.success) {
				   				$('#importProtocols').modal('hide');
				   				$('#importProtocols').data('callback')();
			  	 				showSuccess(data.message);
			 				} else {
			 	  				$('#importProtocols').resourceDialog('error',data.message);
			 				} 
						},
				error : function(jqXHR,textStatus,errorThrown) {
		      				$('#importProtocols').resourceDialog('error',errorThrown);
						},
				complete: function() {
							$('#uploadIcon').removeClass('fa-spinner fa-spin');
							$('#uploadIcon').addClass('fa-upload');
						} 
			});
		});
	});
</script>

